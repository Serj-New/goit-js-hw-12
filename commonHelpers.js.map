{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from \"axios\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nexport async function getImages(userImgTag, currentPage) {\n  const API_KEY = `?key=42244518-9742bcd26a7acdceb08ce98f6`;\n  const BASE_URL = 'https://pixabay.com/api/';\n  const END_POINT = `&q=${userImgTag}&image_type=photo&orientation=horizontal&safesearch=true`;\n  const url = `${BASE_URL}${API_KEY}${END_POINT}`;\n\n  const params = {\n    page: currentPage,\n    per_page: 15\n  }\n\n  try {\n    const res = await axios.get(url, { params });\n    const data = res.data;\n\n    if (data.hits && data.hits.length > 0) {\n      return data;\n    } else {\n      noImageError();\n    } \n  } catch (error) {\n    console.error(error.message);\n  }\n}\n\nconst noImageError = () => \n  iziToast.error({\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n    titleColor: 'white',\n    titleSize: '16px',\n    messageColor: 'white',\n    messageSize: '16px',\n    backgroundColor: '#ef4040',\n    iconUrl: '/img/error.svg',\n    iconColor: 'white',\n    position: 'topRight',\n    maxWidth: '432px',\n  });","'use strict';\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n    imageElem: document.querySelector('.gallery'),\n};\n\nexport default function renderImages(pictures) {\n    const markup = pictures\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\"\"/>\n                <div class=\"img-info\">\n                    <p class=\"info-item\"><b>Likes:</b>${likes}</p>\n                    <p class=\"info-item\"><b>Views:</b>${views}</p>\n                    <p class=\"info-item\"><b>Comments:</b>${comments}</p>\n                    <p class=\"info-item\"><b>Downloads:</b>${downloads}</p>\n                </div>\n            </a>\n        </li>`)\n    .join('');\n\n    refs.imageElem.insertAdjacentHTML('beforeend', markup);\n    const gallery = new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionDelay: 250,\n        captionsData: 'alt',\n      });\n    \n    gallery.refresh();\n};","'use strict';\n\nimport { getImages } from './js/pixabay-api';\nimport renderImages from './js/render-functions';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst STORAGE_KEY = 'image-tag';\n\nconst refs = {\n    imgTagInput: document.querySelector('#search-img'),\n    searchBtn: document.querySelector('.form'),\n    imageElem: document.querySelector('.gallery'),\n    btnLoadMore: document.querySelector('.load-btn'),\n    loader: document.querySelector('.backdrop'),\n};\n\nlet userImgTag;\nlet page;\nlet maxPage;\n\nrefs.imgTagInput.addEventListener('input', onFormInput);\nrefs.searchBtn.addEventListener('submit', onSearchImg);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n\nasync function onSearchImg(evt) {\n    evt.preventDefault();\n    userImgTag = refs.imgTagInput.value.trim();\n    page = 1;\n\n    if (userImgTag === '') {\n        enterTag();\n    } else {\n        showLoader();\n    };\n\n    try {\n        const data = await getImages(userImgTag, page);\n        if (data.totalHits === 0) {\n            noImages();\n        };\n        maxPage = Math.ceil(data.totalHits / 15);\n\n        refs.imageElem.innerHTML = '';\n        showImages(data.hits);\n    } catch (error) {\n        console.log(error.message);\n        oopsError();\n    }\n\n    localStorage.removeItem(STORAGE_KEY);\n    hideLoader();\n    checkBtnVisibleStatus();\n    refs.searchBtn.reset();\n}\n\nasync function onLoadMoreClick() {\n    page += 1;\n    showLoader();\n    const data = await getImages(userImgTag, page);\n    showImages(data.hits);\n\n  \n    const height =\n      refs.imageElem.firstElementChild.getBoundingClientRect().height;\n  \n    scrollBy({\n      behavior: 'smooth',\n      top: 10,\n    });\n    \n    hideLoader();\n    checkBtnVisibleStatus();\n  }\n\n// вводим данные, сохраняем в локал сторедж и достаем их оттуда, если закрылась страница =================================\n\nfunction saveToLS(key, value) {\n    const archive = JSON.stringify(value);\n    localStorage.setItem(key, archive);\n}\n\nfunction onFormInput() {\n  const tag = refs.imgTagInput.value.trim();\n\n  const data = {\n      tag,\n  };\n\n  saveToLS(STORAGE_KEY, data);\n}\n\nfunction loadFromLS(key) {\n    const archive = localStorage.getItem(key);\n\n    try {\n        return JSON.parse(archive);\n    } catch (error) {\n        console.error('Error parsing JSON from localStorage:', error);\n        return {};\n    }\n}\n\nfunction init() {\n    const data = loadFromLS(STORAGE_KEY) || {};\n    refs.imgTagInput.value = data.tag || '';\n}\n\ninit();\n\n// Gallery ==============================================\n\nfunction showImages(images) {\n    const markup = renderImages(images);\n    refs.imageElem.insertAdjacentHTML('beforeend', markup);\n}\n\n// loader, more btn ======================================\n\nfunction showLoadBtn() {\n    refs.btnLoadMore.classList.remove('hidden');\n}\n\nfunction hideLoadBtn() {\n    refs.btnLoadMore.classList.add('hidden');\n}\n  \nfunction showLoader() {\n    refs.loader.classList.add('is-open');\n}\n\nfunction hideLoader() {\n    refs.loader.classList.remove('is-open');\n}\n\nfunction checkBtnVisibleStatus() {\n    if (page >= maxPage) {\n      hideLoadBtn();\n    } else {\n      showLoadBtn();\n    }\n}\n\n// ОШИБКИ ================================================\n\nconst enterTag = () => \n    iziToast.error({\n        message: 'Please enter a search tag',\n        titleColor: 'white',\n        titleSize: '16px',\n        messageColor: 'white',\n        messageSize: '16px',\n        backgroundColor: '#ef4040',\n        iconUrl: './img/error.svg',\n        iconColor: 'white',\n        position: 'topRight',\n    });\n\nconst noImages = () =>\n    iziToast.error({\n        message: 'Sorry, no images found',\n        titleColor: 'white',\n        titleSize: '16px',\n        messageColor: 'white',\n        messageSize: '16px',\n        backgroundColor: '#ef4040',\n        iconUrl: './img/error.svg',\n        iconColor: 'white',\n        position: 'topRight',\n    });\n\nconst oopsError = () =>\n    iziToast.error({\n        message: 'Oops...',\n        titleColor: 'white',\n        titleSize: '16px',\n        messageColor: 'white',\n        messageSize: '16px',\n        backgroundColor: '#ef4040',\n        iconUrl: './img/error.svg',\n        iconColor: 'white',\n        position: 'topRight',\n    });"],"names":["getImages","userImgTag","currentPage","API_KEY","BASE_URL","END_POINT","url","params","data","axios","noImageError","error","iziToast","refs","renderImages","pictures","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","STORAGE_KEY","page","maxPage","onFormInput","onSearchImg","onLoadMoreClick","evt","enterTag","showLoader","noImages","showImages","oopsError","hideLoader","checkBtnVisibleStatus","saveToLS","key","value","archive","loadFromLS","init","images","showLoadBtn","hideLoadBtn"],"mappings":"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"}